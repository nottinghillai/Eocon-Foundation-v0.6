---
converted: '2025-10-25'
source: AlgorithmforDecisionMaking.pdf
title: ) +
---

# ) +

_Source page: 244_



log


log


log


© 2022 Massachusetts Institute of Technology, shared under a Creative Commons CC-BY-NC-ND license.


2025-09-21 10:49:56-07:00, comments to bugs@algorithmsbook.com


10.5. evolution strategies


223


Figure


10.6.


Several


weight-


0.5


ings


constructed


using


equa-


tion (10.13).


10


weight,


0.5


10


index in order by decreasing expected utility,


Algorithm 10.5.


An evolution


struct


EvolutionStrategies


strategies method for updating a


# distribution constructor


search distribution


over pol-


# initial distribution parameterization


icy parameterizations for policy


∇logp


# log search likelihood gradient


. This implementation also


# number of samples


takes an initial search distribution


# step factor


k_max


# number of iterations


parameterization


, the log search


end


likelihood gradient


∇logp


a policy evaluation function


function


evolution_strategy_weights


and an iteration count


k_max


. In


ws


max


log


log


))


for


in 1


each iteration,


parameteriza-


ws


/=


sum


ws


tion samples are drawn and are


ws


-=


used to estimate the search gradi-


return


ws


ent. This gradient is then applied


end


with a step factor


. We can use


Distributions.jl


to define


function


optimize_dist


::


EvolutionStrategies


For example, if we want to define


∇logp


∇logp


to construct a Gaussian with a


ws


evolution_strategy_weights


given mean


and fixed covariance


for


in 1


k_max


, we can use


θs


rand


),


MvNormal


us


θs


])


for


in 1


sp


sortperm


us


rev


true


sum


∇logp


θs


])


for


in


zip


ws


sp


))


+=


end


return


end


© 2022 Massachusetts Institute of Technology, shared under a Creative Commons CC-BY-NC-ND license.


2025-09-21 10:49:56-07:00, comments to bugs@algorithmsbook.com


224


chapter 10. policy search


Figure 10.7. Evolution strategies


(algorithm 10.5) applied to the sim-


ple regulator problem using a mul-


tivariate Gaussian search distribu-


tion. Samples are shown in white,


along with their search gradient


contributions,


log