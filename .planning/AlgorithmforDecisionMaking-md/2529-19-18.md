---
converted: '2025-10-25'
source: AlgorithmforDecisionMaking.pdf
title: (19.18)
---

# (19.18)

_Source page: 407_



© 2022 Massachusetts Institute of Technology, shared under a Creative Commons CC-BY-NC-ND license.


2025-09-21 10:49:56-07:00, comments to bugs@algorithmsbook.com


386


chapter 19. beliefs


where


and


are differentiable functions.


Exact belief updates through nonlinear dynamics are not guaranteed to pro-


duce new Gaussian beliefs, as shown in figure 19.3. The extended Kalman filter


uses a local linear approximation to the nonlinear dynamics, thereby producing


a new Gaussian belief that approximates the true updated belief. We can use


similar update equations as the Kalman filter, but we must compute the matrices


and


at every iteration based on the current belief.


The local linear approximation to the dynamics, or


linearization


, is given by first-


The Jacobian of a multivariate


order Taylor expansions in the form of Jacobians.


For the state matrix, the Taylor


function


with


inputs and


out-


expansion is conducted at


and the current action, whereas for the observation


puts is an


matrix where the


matrix, it is computed at the predicted mean,


th entry is


The extended Kalman filter is implemented in algorithm 19.4. Although it is


an approximation, it is fast and performs well on a variety of real-world problems.


The EKF does not generally preserve the true mean and variance of the posterior,


and it does not model multimodal posterior distributions.


Algorithm 19.4.


The extended


struct


ExtendedKalmanFilter


Kalman filter, an extension of the


μb


# mean vector


Kalman filter to problems with


Σb


# covariance matrix


nonlinear Gaussian dynamics. The


end


current belief is represented by


mean


μb


and covariance


Σb


. The


import


ForwardDiff


jacobian


function


update


::


ExtendedKalmanFilter


problem


specifies the nonlinear


μb


Σb


μb


Σb


dynamics using the mean tran-


fT


fO


fT


fO


sition dynamics function


fT


and


Σs


Σo


Σs


Σo


mean observation dynamics func-


# predict


tion


fO


. The Jacobians are obtained


μp


fT


μb


using the


ForwardDiff.jl


pack-


Ts


jacobian


->


fT


),


μb


age.


Os


jacobian


fO


μp


Σp


Ts


Σb


Ts


' +


Σs


# update


Σpo


Σp


Os


Σpo


Os


Σp


Os


' +


Σo


μb′


μp


fO


μp


))


Σb′


Os


Σp


return


ExtendedKalmanFilter


μb′


Σb′


end


© 2022 Massachusetts Institute of Technology, shared under a Creative Commons CC-BY-NC-ND license.


2025-09-21 10:49:56-07:00, comments to bugs@algorithmsbook.com


19.5. unscented kalman filter


387


Figure 19.3. Updating a Gaussian


belief with a linear transform (left)


produces another Gaussian distri-


bution. Updating a Gaussian belief