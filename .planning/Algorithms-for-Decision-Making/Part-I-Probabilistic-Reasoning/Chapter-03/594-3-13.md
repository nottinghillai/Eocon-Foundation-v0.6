---
converted: '2025-10-25'
source: AlgorithmforDecisionMaking.pdf
title: (3.13)
---

# (3.13)

_Source page: 73_



© 2022 Massachusetts Institute of Technology, shared under a Creative Commons CC-BY-NC-ND license.


2025-09-21 10:49:56-07:00, comments to bugs@algorithmsbook.com


52


chapter 3. inference


The sum-product variable elimination algorithm is implemented in algorithm 3.5.


It takes as input a Bayesian network, a set of query variables, a list of observed


values, and an ordering of the variables. We first set all observed values. Then,


for each variable, we multiply all factors containing it and then marginalize that


variable out. This new factor replaces the consumed factors, and we repeat the


process for the next variable.


For many networks, variable elimination allows inference to be done in an


amount of time that scales linearly with the size of the network, but it has ex-


ponential time complexity in the worst case. What influences the amount of


computation is the variable elimination order. Choosing the optimal elimina-


S. Arnborg, D. G. Corneil, and


tion order is


NP-hard


meaning that it cannot be done in polynomial time in the


A. Proskurowski, “Complexity of


worst case (section 3.5). Even if we found the optimal elimination order, variable


Finding Embeddings in a


-Tree,”


elimination can still require an exponential number of computations. Variable


SIAM Journal on Algebraic Discrete


Methods


, vol. 8, no. 2, pp. 277–284,


elimination heuristics generally try to minimize the number of variables involved


1987.


in the intermediate factors generated by the algorithm.


Algorithm 3.5.


An implementa-


struct


VariableElimination


tion of the sum-product variable


ordering


# array of variable indices


elimination algorithm, which takes


end


in a Bayesian network


bn


, a list


of query variables


query


, and ev-


function


infer


::


VariableElimination


bn


query


evidence


idence


evidence


. The variables are


condition


evidence


for


in


bn


factors


for


in


ordering


processed in the order given by


name


bn


vars


].


name


ordering


if


name


query


inds


findall


->


in_scope


name


),


if


isempty


inds


prod


inds


])


deleteat!


inds


marginalize


name


push!


end


end


end


return


normalize!


prod


))


end


© 2022 Massachusetts Institute of Technology, shared under a Creative Commons CC-BY-NC-ND license.


2025-09-21 10:49:56-07:00, comments to bugs@algorithmsbook.com


3.4. belief propagation


53