---
converted: '2025-10-25'
source: AlgorithmforDecisionMaking.pdf
title: (3.17)
---

# (3.17)

_Source page: 79_



To generate these weighted samples, we begin with a topological sort and


sample from the conditional distributions in sequence. The only difference in


likelihood weighting is how we handle observed variables. Instead of sampling


their values from a conditional distribution, we assign variables to their observed


values and adjust the weight of the sample appropriately. The weight of a sample


is simply the product of the conditional probabilities at the observed nodes.


Likelihood weighted sampling is implemented in algorithm 3.8. Example 3.6


demonstrates inference with likelihood weighted sampling.


© 2022 Massachusetts Institute of Technology, shared under a Creative Commons CC-BY-NC-ND license.


2025-09-21 10:49:56-07:00, comments to bugs@algorithmsbook.com


58


chapter 3. inference


Algorithm 3.8.


The likelihood


struct


LikelihoodWeightedSampling


weighted


sampling


inference


# number of samples


method, which takes a Bayesian


end


network


bn


list


of


query


variables


query


and


evidence


function


infer


::


LikelihoodWeightedSampling


bn


query


evidence


evidence


The


method


draws


table


FactorTable


()


ordering


topological_sort


bn


graph


samples


from


the


Bayesian


for


in 1


network but sets values from


Assignment


(),


1.0


evidence when possible, keeping


for


in


ordering


track of the conditional probability


name


bn


vars


].


name


bn


factors


when doing so. These probabilities


if


haskey


evidence


name


are used to weight the samples


name


evidence


name


such


that


the


final


inference


*=


table


select


variablenames


))]


estimate is accurate. A factor over


else


the query variables is returned.


name


rand


condition


))[


name


end


end


select


query


table


get


table


end


vars


filter


->


name


query


bn


vars


return


normalize!


Factor


vars


table


))


end


© 2022 Massachusetts Institute of Technology, shared under a Creative Commons CC-BY-NC-ND license.


2025-09-21 10:49:56-07:00, comments to bugs@algorithmsbook.com


3.7. likelihood weighted sampling


59


Example 3.6. Likelihood weighted


The table here shows five likelihood weighted samples from the network in


samples from a Bayesian network.


figure 3.1. We sample from


, and


, as we would with


direct sampling. When we come to


and


, we assign


and


. If


the sample has


, then the weight is


; otherwise, the


weight is


. If we assume