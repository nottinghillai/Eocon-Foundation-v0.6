---
converted: '2025-10-25'
source: AlgorithmforDecisionMaking.pdf
title: (3.15)
---

# (3.15)

_Source page: 76_



ized Algorithms


. Cambridge Univer-


sity Press, 1995.


We use the convention where a logical statement in parentheses is treated numer-


ically as


when true and


when false. The numerator is the number of samples


consistent with


, and


all set to


, and the denominator is the number of


samples consistent with


and


all set to


© 2022 Massachusetts Institute of Technology, shared under a Creative Commons CC-BY-NC-ND license.


2025-09-21 10:49:56-07:00, comments to bugs@algorithmsbook.com


3.6. direct sampling


55


Sampling from the joint distribution represented by a Bayesian network is


straightforward. The first step involves finding a


topological sort


of the nodes in the


Bayesian network. A topological sort of the nodes in a directed acyclic graph is


an ordered list such that if there is an edge


, then


comes before


in the


A. B. Kahn, “Topological Sorting


list.


For example, a topological sort for the network in figure 3.1 is


of Large Networks,”


Communica-


A topological sort always exists, but it may not be unique. Another topological


tions of the ACM


, vol. 5, no. 11,


sort for the network is


pp. 558–562, 1962. An implemen-


tation of topological sorting is pro-


Once we have a topological sort, we can begin sampling from the conditional


vided by the


Graphs.jl


package.


probability distributions. Algorithm 3.6 shows how to sample from a Bayesian


network given an ordering


1:


that represents a topological sort. We draw a


sample from the conditional distribution associated with


given the values of


the parents that have already been assigned. Because


1:


is a topological sort,


we know that all the parents of


have already been instantiated, allowing this


sampling to be done. Direct sampling is implemented in algorithm 3.7 and is


demonstrated in example 3.5.


Algorithm 3.6.


A method for


function


Base


rand


::


Factor


sampling an assignment from a


tot


0.0


rand


(),


sum


values


table


))


Bayesian network


bn


. We also pro-


for


in


table


vide a method for sampling an as-


tot


+=


signment from a factor


if


tot


>=


return


end


end


return


Assignment


()


end


function


Base


rand


bn


::


BayesianNetwork


Assignment


()


for


in


topological_sort


bn


graph


name


bn


vars


].


name


bn


factors


name


rand


condition


))[


name


end


return


end


© 2022 Massachusetts Institute of Technology, shared under a Creative Commons CC-BY-NC-ND license.


2025-09-21 10:49:56-07:00, comments to bugs@algorithmsbook.com


56


chapter 3. inference


Example 3.5. An example of how


Suppose we draw


10


random samples from the network in figure 3.1. We


direct samples from a Bayesian net-


are interested in inferring


. Only 2 of the 10 samples (pointed


work can be used for inference.


to in the table) are consistent with observations


and


. One sample has


, and the other sample has


. From these samples, we infer that